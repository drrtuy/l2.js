<script type="text/javascript" src="../dist/l2.js"></script>
<script type="text/javascript">
	console.log("test")
	window.addEventListener('load', function() {

  // Checking if Web3 has been injected by the browser (Mist/MetaMask)
  if (typeof web3 !== 'undefined') {
    // Use Mist/MetaMask's provider
    web3js = new Web3(web3.currentProvider);
  } else {
    console.log('No web3? You should consider trying MetaMask!')
    // fallback - use your fallback strategy (local node / hosted node + in-dapp id mgmt / fail)
    web3js = new Web3(new Web3.providers.HttpProvider("http://localhost:8545"));
  }

  // Now you can start your app & access web3 freely:
  //startApp()
  console.log(web3js);
/*
var eth_abiFile='[{"constant":true,"inputs":[],"name":"challenge_period","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"id","type":"uint32"},{"name":"vA","type":"uint256"},{"name":"vB","type":"uint256"},{"name":"h","type":"uint256"},{"name":"pi","type":"uint256"},{"name":"v","type":"uint8"},{"name":"r","type":"bytes32"},{"name":"s","type":"bytes32"}],"name":"challengeUpdate","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"id","type":"uint32"},{"name":"vA","type":"uint256"},{"name":"vB","type":"uint256"},{"name":"h","type":"uint256"},{"name":"pi","type":"uint256"},{"name":"v","type":"uint8"},{"name":"r","type":"bytes32"},{"name":"s","type":"bytes32"}],"name":"challengeFinish","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"B","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[],"name":"withdraw","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"h","type":"uint256"},{"name":"pi","type":"bytes"}],"name":"testHL","outputs":[{"name":"","type":"uint256"},{"name":"","type":"bool"}],"payable":false,"stateMutability":"pure","type":"function"},{"constant":false,"inputs":[{"name":"id","type":"uint32"},{"name":"vA","type":"uint256"},{"name":"vB","type":"uint256"},{"name":"h","type":"uint256"},{"name":"pi","type":"bytes"},{"name":"v","type":"uint8"},{"name":"r","type":"bytes32"},{"name":"s","type":"bytes32"}],"name":"challengeStart","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"addr","type":"address"}],"name":"valueX","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"id","type":"uint32"},{"name":"vA","type":"uint256"},{"name":"vB","type":"uint256"},{"name":"h","type":"uint256"},{"name":"pi","type":"bytes"},{"name":"v","type":"uint8"},{"name":"r","type":"bytes32"},{"name":"s","type":"bytes32"}],"name":"testSig","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"sum","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"mv","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"ChannelInfo","outputs":[{"name":"","type":"address"},{"name":"","type":"address"},{"name":"","type":"uint256"},{"name":"","type":"uint256"},{"name":"","type":"uint256"},{"name":"","type":"uint32"},{"name":"","type":"uint8"},{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"id","type":"uint32"},{"name":"vA","type":"uint256"},{"name":"vB","type":"uint256"},{"name":"h","type":"uint256"},{"name":"pi","type":"uint256"},{"name":"v","type":"uint8"},{"name":"r","type":"bytes32"},{"name":"s","type":"bytes32"}],"name":"challengePenalty","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"balance","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"state","outputs":[{"name":"","type":"uint8"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"A","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"inputs":[{"name":"_B","type":"address"},{"name":"_ttl","type":"uint256"},{"name":"_mv","type":"uint256"}],"payable":true,"stateMutability":"payable","type":"constructor"},{"payable":true,"stateMutability":"payable","type":"fallback"},{"anonymous":false,"inputs":[{"indexed":false,"name":"sender","type":"address"},{"indexed":false,"name":"value","type":"uint256"}],"name":"OnPayment","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"sender","type":"address"},{"indexed":false,"name":"id","type":"uint32"},{"indexed":false,"name":"vA","type":"uint256"},{"indexed":false,"name":"vB","type":"uint256"},{"indexed":false,"name":"v","type":"uint8"},{"indexed":false,"name":"r","type":"bytes32"},{"indexed":false,"name":"s","type":"bytes32"}],"name":"OnChallengeStart","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"sender","type":"address"},{"indexed":false,"name":"id","type":"uint32"},{"indexed":false,"name":"vA","type":"uint256"},{"indexed":false,"name":"vB","type":"uint256"},{"indexed":false,"name":"v","type":"uint8"},{"indexed":false,"name":"r","type":"bytes32"},{"indexed":false,"name":"s","type":"bytes32"}],"name":"OnChallengeUpdate","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"sender","type":"address"},{"indexed":false,"name":"id","type":"uint32"},{"indexed":false,"name":"vA","type":"uint256"},{"indexed":false,"name":"vB","type":"uint256"},{"indexed":false,"name":"v","type":"uint8"},{"indexed":false,"name":"r","type":"bytes32"},{"indexed":false,"name":"s","type":"bytes32"}],"name":"OnChallengePenalty","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"sender","type":"address"},{"indexed":false,"name":"id","type":"uint32"},{"indexed":false,"name":"vA","type":"uint256"},{"indexed":false,"name":"vB","type":"uint256"},{"indexed":false,"name":"v","type":"uint8"},{"indexed":false,"name":"r","type":"bytes32"},{"indexed":false,"name":"s","type":"bytes32"}],"name":"OnChallengeFinish","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"sender","type":"address"},{"indexed":false,"name":"value","type":"uint256"}],"name":"OnWithdraw","type":"event"}]';



var eth_bin = '60806040526040516060806110d38339810160409081528151602083015191909201516000805433600160a060020a031991821617825560018054909116600160a060020a0386161790554283016007556005556006805463ffffffff1916905560048190553481111561007257600080fd5b60003411156100ac5733600090815260026020526040902034908190556006805464ff0000000019166401000000001790556003556100c0565b60006003556006805464ff00000000191690555b505050611001806100d26000396000f3006080604052600436106100cc5763ffffffff60e060020a6000350416630a00840c81146101a85780630eac61eb146101cf5780631c7e0fef1461020757806332e7c5bf1461023d5780633ccfd60b1461026e5780634af94a14146102835780635d5ba694146102fa578063764ded781461037a5780637b86de1b1461039b578063853255cc1461042f5780638f05cdf5146104445780639853fde714610459578063a63f0f4c146104c4578063b69ef8a8146104fa578063c19d93fb1461050f578063f446c1d014610548575b600054600160a060020a03163314806100ef5750600154600160a060020a031633145b15156100fa57600080fd5b60045434101561010957600080fd5b6000341161011657600080fd5b336000908152600260205260408120805434019055600654640100000000900460ff16600381111561014457fe5b1415610160576006805464ff0000000019166401000000001790555b600380543490810190915560408051338152602081019290925280517fb15a6adf286d1f42c125914b33004ee871c52b4c02245d5f5d7c7af1499f17b99281900390910190a1005b3480156101b457600080fd5b506101bd61055d565b60408051918252519081900360200190f35b3480156101db57600080fd5b5061020563ffffffff6004351660243560443560643560843560ff60a4351660c43560e435610562565b005b34801561021357600080fd5b5061020563ffffffff6004351660243560443560643560843560ff60a4351660c43560e435610672565b34801561024957600080fd5b5061025261084c565b60408051600160a060020a039092168252519081900360200190f35b34801561027a57600080fd5b5061020561085b565b34801561028f57600080fd5b5060408051602060046024803582810135601f81018590048502860185019096528585526102e19583359536956044949193909101919081908401838280828437509497506109349650505050505050565b6040805192835290151560208301528051918290030190f35b34801561030657600080fd5b50604080516020601f6084356004818101359283018490048402850184019095528184526102059463ffffffff813516946024803595604435956064359536959460a49490939101919081908401838280828437509497505050833560ff1694505050602082013591604001359050610a13565b34801561038657600080fd5b506101bd600160a060020a0360043516610b84565b3480156103a757600080fd5b50604080516020601f60843560048181013592830184900484028501840190955281845261041b9463ffffffff813516946024803595604435956064359536959460a49490939101919081908401838280828437509497505050833560ff1694505050602082013591604001359050610b9f565b604080519115158252519081900360200190f35b34801561043b57600080fd5b506101bd610bbf565b34801561045057600080fd5b506101bd610bc5565b34801561046557600080fd5b5061046e610bcb565b60408051600160a060020a03998a168152979098166020880152868801959095526060860193909352608085019190915263ffffffff1660a084015260ff1660c083015260e08201529051908190036101000190f35b3480156104d057600080fd5b5061020563ffffffff6004351660243560443560643560843560ff60a4351660c43560e435610c49565b34801561050657600080fd5b506101bd610dd1565b34801561051b57600080fd5b50610524610dd7565b6040518082600381111561053457fe5b60ff16815260200191505060405180910390f35b34801561055457600080fd5b50610252610de8565b603c81565b6002600654640100000000900460ff16600381111561057d57fe5b1461058757600080fd5b600060035411801561059c5750858701600354145b15156105a757600080fd5b84156105ca5760408051858152905190819003602001902085146105ca57600080fd5b6105d988888888878787610df7565b60065463ffffffff908116908916116105f157600080fd5b6006805463ffffffff8a1663ffffffff1990911681179091556040805133815260208101929092528181018990526060820188905260ff8516608083015260a0820184905260c08201839052517fe2e392a77b0b8007185ec060accbc9c9c0213ed9f01717241ba25ac1111bd37d9181900360e00190a15050505050505050565b6002600654640100000000900460ff16600381111561068d57fe5b1461069757600080fd5b60055442116106a557600080fd5b60006003541180156106ba5750858701600354145b15156106c557600080fd5b84156106e85760408051858152905190819003602001902085146106e857600080fd5b6106f788888888878787610df7565b60065463ffffffff89811691161461070e57600080fd5b60008711156107525760008054604051600160a060020a039091169189156108fc02918a91818181858888f19350505050158015610750573d6000803e3d6000fd5b505b600086111561079757600154604051600160a060020a039091169087156108fc029088906000818181858888f19350505050158015610795573d6000803e3d6000fd5b505b60008054600160a060020a039081168252600260205260408083208390556001549091168252812081905560039081556006805464ff0000000019166401000000008302179055506040805133815263ffffffff8a1660208201528082018990526060810188905260ff8516608082015260a0810184905260c0810183905290517fc54208ba3c9063f00abf17263b23fade72d920f61b8ff1df4f469c277b58c08c9181900360e00190a15050505050505050565b600154600160a060020a031681565b60006003600654640100000000900460ff16600381111561087857fe5b141561088357600080fd5b50336000908152600260205260408120549081116108a057600080fd5b60075442116108ae57600080fd5b604051339082156108fc029083906000818181858888f193505050501580156108db573d6000803e3d6000fd5b50600380548290039055336000818152600260209081526040808320929092558151928352820183905280517fbace9fd79d5ea02ed8b43fa96af07e4e8f859a2f71ff878c748f5c22c57802849281900390910190a150565b6000806000836040518082805190602001908083835b602083106109695780518252601f19909201916020918201910161094a565b5181516020939093036101000a6000190180199091169216919091179052604051920182900390912093505086159150610a08905057836040518082805190602001908083835b602083106109cf5780518252601f1990920191602091820191016109b0565b5181516020939093036101000a6000190180199091169216919091179052604051920182900390912088149250610a0891505057600080fd5b949385149392505050565b6001600654640100000000900460ff166003811115610a2e57fe5b14610a3857600080fd5b6000600354118015610a4d5750858701600354145b1515610a5857600080fd5b8415610ac757836040518082805190602001908083835b60208310610a8e5780518252601f199092019160209182019101610a6f565b5181516020939093036101000a6000190180199091169216919091179052604051920182900390912088149250610ac791505057600080fd5b610ad688888888878787610df7565b60065463ffffffff90811690891611610aee57600080fd5b60068054603c420160055563ffffffff191663ffffffff8a1690811764ff000000001916640200000000179091556040805133815260208101929092528181018990526060820188905260ff8516608083015260a0820184905260c08201839052517f9839dce150ba01a835bab8482508611955125297732fce5e4720ec5b98a4d2449181900360e00190a15050505050505050565b600160a060020a031660009081526002602052604090205490565b6000610bb089898989888888610df7565b50600198975050505050505050565b60035481565b60045481565b60008054600154600160a060020a03918216808452600260205260408085205492909316808552928420546005546006548695869586958695869586958695939492919063ffffffff81169060ff640100000000909104166003811115610c2e57fe5b600754969f959e50939c50919a509850965094509092509050565b6002600654640100000000900460ff166003811115610c6457fe5b14610c6e57600080fd5b6000600354118015610c835750858701600354145b1515610c8e57600080fd5b8415610cb1576040805185815290519081900360200190208514610cb157600080fd5b610cc088888888878787610df7565b60065463ffffffff90811690891611610cd857600080fd5b6006805463ffffffff191663ffffffff8a1617905560035460405133916108fc811502916000818181858888f19350505050158015610d1b573d6000803e3d6000fd5b5060008054600160a060020a039081168252600260205260408083208390556001549091168252812081905560039081556006805464ff0000000019166401000000008302179055506040805133815263ffffffff8a1660208201528082018990526060810188905260ff8516608082015260a0810184905260c0810183905290517f82bc415e32b7c2ebbcaf7a4a8e42748c84bc5d9bdfd3333c051634f0533992c19181900360e00190a15050505050505050565b60035490565b600654640100000000900460ff1681565b600054600160a060020a031681565b600054600160a060020a0316331415610ee15760008054604080516c010000000000000000000000003081028252600160a060020a0390931692909202601483015260e060020a63ffffffff8b16026028830152602c8201899052604c8201889052805191829003606c01822083835260208381018084529190915260ff8716838301526060830186905260808301859052905160019360a080850194601f198401939081900390910191865af1158015610eb6573d6000803e3d6000fd5b5050604051601f190151600154600160a060020a039081169116149050610edc57600080fd5b610fcc565b600154600160a060020a0316331415610fc75760018054604080516c010000000000000000000000003081028252600160a060020a0390931692909202601483015260e060020a63ffffffff8b16026028830152602c8201899052604c8201889052805191829003606c018220600080845260208481018085529290925260ff8816848401526060840187905260808401869052915160a0808501949293601f198301938390039091019190865af1158015610fa1573d6000803e3d6000fd5b5050604051601f190151600054600160a060020a039081169116149050610edc57600080fd5b600080fd5b505050505050505600a165627a7a7230582041a923b64f8f465d7c57cd1d8c9865f0fb16f2e94096b735c912a15f367188870029';
var eth_abi = JSON.parse(eth_abiFile);  
*/
console.log(l2)

 const l2inst=new l2('eth',{web3:web3js, abi:eth_abi, bin:eth_bin})

  console.log(l2inst)

  var B="07b1032016aa26925049cedb2a3bd71fbb94a07b"
var v=0.777
var ch=l2inst.channel_open(v,B,3600,0).then(function(r){console.log(r)})
console.log('ch',ch)

})
</script>
